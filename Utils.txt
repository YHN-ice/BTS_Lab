*** Settings ***
Library           Selenium2Library

*** Keywords ***
Login
    [Arguments]    ${user}=JT2204213235    ${password}=imbusadmin12345
    Open Browser    http://10.176.122.171:8080/    gc    options=use_chromium=True
    input text    css=#app > div > div.formbox > form > div:nth-child(1) > div > div > input    ${user}
    input text    css=#app > div > div.formbox > form > div:nth-child(2) > div > div > input    ${password}
    Click Button    css=#app > div > div.formbox > form > div.el-form-item.subbtn.el-form-item--feedback.el-form-item--mini > div > button
    sleep    2
    ${Greeting}    Get Text    css=#welcome > div > div.fullName.leftclass
    Should Contain    ${Greeting}    欢迎

ClickManageButton
    ${novisible}    Run Keyword And Return Status    Element Should Not Be Visible    css=#el-menu-vertical-demo > li:nth-child(4) > ul > div > li:nth-child(1)
    Run Keyword If    ${novisible}    Myclick    css=#el-menu-vertical-demo > li:nth-child(4) > div > span
    Wait Until Page Contains Element    css=#el-menu-vertical-demo > li:nth-child(4) > ul > div > li:nth-child(1)
    Myclick    css=#el-menu-vertical-demo > li:nth-child(4) > ul > div > li:nth-child(1)

ClickLargePayButton
    ${novisible}    Run Keyword And Return Status    Element Should Not Be Visible    Xpath=//*[@id="el-menu-vertical-demo"]/li[4]/ul/div/li[6]
    Run Keyword If    ${novisible}    Myclick    css=#el-menu-vertical-demo > li:nth-child(4) > div > span
    Wait Until Page Contains Element    css=#el-menu-vertical-demo > li:nth-child(4) > ul > div > li:nth-child(1)
    Myclick    Xpath=//*[@id="el-menu-vertical-demo"]/li[4]/ul/div/li[6]

SearchForCheckout
    [Arguments]    ${applicant}
    Wait Until Page Contains Element    Xpath=//*[@id="app"]/div/div[2]/div/div[2]/div/div/div[1]/div[1]/div[2]/input
    Wait Until Element Is Visible    Xpath=//*[@id="app"]/div/div[2]/div/div[2]/div/div/div[1]/div[1]/div[2]/input
    Input Text    Xpath=//*[@id="app"]/div/div[2]/div/div[2]/div/div/div[1]/div[1]/div[2]/input    ${applicant}
    Myclick    Xpath=/html/body/div[1]/div/div[2]/div/div[2]/div/div/div[1]/div[2]/div[2]/div/input
    Myclick    css=ul > li.el-select-dropdown__item:nth-child(1) > span
    Click Button    css=#app > div > div.layleft > div > div.padd > div > div > div.el-row > div:nth-child(3) > button:nth-child(1)

SearchForPress
    [Arguments]    ${applicant}
    Wait Until Page Contains Element    css=#app > div > div.layleft > div > div.padd > div > div > div.el-row > div:nth-child(1) > div.el-input.el-input--mini.el-input--suffix > input
    Input Text    css=#app > div > div.layleft > div > div.padd > div > div > div.el-row > div:nth-child(1) > div.el-input.el-input--mini.el-input--suffix > input    ${applicant}
    Myclick    Xpath=/html/body/div[1]/div/div[2]/div/div[2]/div/div/div[1]/div[2]/div[2]/div/input
    Myclick    css=ul > li.el-select-dropdown__item:nth-child(2) > span
    Click Button    css=#app > div > div.layleft > div > div.padd > div > div > div.el-row > div:nth-child(3) > button:nth-child(1)

CreateTicket
    [Arguments]    ${applicant}    ${receiver}    ${amount}    ${comment}=comment
    Wait Until Page Contains Element    css=#app > div > div.layleft > div > div.padd > div > div > div.el-row > div:nth-child(3) > button:nth-child(2)
    Click Button    css=#app > div > div.layleft > div > div.padd > div > div > div.el-row > div:nth-child(3) > button:nth-child(2)
    input text    css=#app > div > div.layleft > div > div.padd > div > div > div:nth-child(4) > div > div > div.el-dialog__body > form > div > div:nth-child(1) > div > div > div.el-input.el-input--mini.el-input--suffix > input    ${applicant}
    input text    css=#app > div > div.layleft > div > div.padd > div > div > div:nth-child(4) > div > div > div.el-dialog__body > form > div > div:nth-child(2) > div > div > div > input    ${receiver}
    input text    css=#app > div > div.layleft > div > div.padd > div > div > div:nth-child(4) > div > div > div.el-dialog__body > form > div > div:nth-child(4) > div > div > div > input    ${amount}
    input text    css=#app > div > div.layleft > div > div.padd > div > div > div:nth-child(4) > div > div > div.el-dialog__body > form > div > div:nth-child(7) > div > div > div > textarea    ${comment}
    click button    css=#app > div > div.layleft > div > div.padd > div > div > div:nth-child(4) > div > div > div.el-dialog__footer > div > button.el-button.el-button--primary.el-button--mini
    ${applicantE}=    Run Keyword And Return Status    Page Should Contain Element    css=#app > div > div.layleft > div > div.padd > div > div > div:nth-child(4) > div > div > div.el-dialog__body > form > div > div:nth-child(1) > div > div > div.el-form-item__error
    ${receiverE}=    Run Keyword And Return Status    Page Should Contain Element    css=#app > div > div.layleft > div > div.padd > div > div > div:nth-child(4) > div > div > div.el-dialog__body > form > div > div:nth-child(2) > div > div > div.el-form-item__error
    ${amountE}=    Run Keyword And Return Status    Page Should Contain Element    css=#app > div > div.layleft > div > div.padd > div > div > div:nth-child(4) > div > div > div.el-dialog__body > form > div > div:nth-child(4) > div > div > div.el-form-item__error
    ${success}=    Run Keyword And Return Status    MyContain    新增成功
    Run Keyword If    ${receiverE}    LogError    css=#app > div > div.layleft > div > div.padd > div > div > div:nth-child(4) > div > div > div.el-dialog__body > form > div > div:nth-child(2) > div > div > div.el-form-item__error
    Run Keyword If    ${applicantE}    LogError    css=#app > div > div.layleft > div > div.padd > div > div > div:nth-child(4) > div > div > div.el-dialog__body > form > div > div:nth-child(1) > div > div > div.el-form-item__error
    Run Keyword If    ${amountE}    LogError    css=#app > div > div.layleft > div > div.padd > div > div > div:nth-child(4) > div > div > div.el-dialog__body > form > div > div:nth-child(4) > div > div > div.el-form-item__error
    Should Be True    ${success}

LogError
    [Arguments]    ${location}
    ${receiverM}    Get Text    ${location}
    log    ${receiverM}

Myclick
    [Arguments]    ${location}
    Wait Until Keyword Succeeds    15 s    5 s    myclickraw    ${location}

MyContain
    [Arguments]    ${msg}
    Wait Until Keyword Succeeds    1 s    0 s    Page Should Contain    ${msg}

myclickraw
    [Arguments]    ${location}
    Wait Until Element Is Visible    ${location}
    Mouse over    ${location}
    Mouse down    ${location}
    Mouse up    ${location}

Checkout
    [Arguments]    ${code}=123456
    Wait Until Page Contains Element    css=#app > div > div.layleft > div > div.padd > div > div > div.el-table > div> table > tbody > tr > td.el-table_1_column_9 > div > button:nth-child(1)
    Myclick    css=#app > div > div.layleft > div > div.padd > div > div > div.el-table > div> table > tbody > tr > td.el-table_1_column_9 > div > button:nth-child(1)
    Input Text    css=#app > div > div.layleft > div > div.padd > div > div > div:nth-child(4) > div > div > div.el-dialog__body > form > div > div:nth-child(7) > div > div > div > input    ${code}
    Click Button    css=#app > div > div.layleft > div > div.padd > div > div > div:nth-child(4) > div > div > div.el-dialog__footer > div > button.el-button.el-button--primary.el-button--mini
    sleep    2
    ${codeE}=    Run Keyword And Return Status    Page Should Contain Element    css=#app > div > div.layleft > div > div.padd > div > div > div:nth-child(4) > div > div > div.el-dialog__body > form > div > div:nth-child(7) > div > div > div.el-form-item__error
    ${success}=    Run Keyword And Return Status    MyContain    操作成功
    Run Keyword If    ${codeE}    LogError    css=#app > div > div.layleft > div > div.padd > div > div > div:nth-child(4) > div > div > div.el-dialog__body > form > div > div:nth-child(7) > div > div > div.el-form-item__error
    Should Be True    ${success}

Press
    [Arguments]    ${amount}
    Wait Until Page Contains Element    css=#app > div > div.layleft > div > div.padd > div > div > div.el-table > div> table > tbody > tr > td.el-table_1_column_9 > div > button:nth-child(1)
    Myclick    css=#app > div > div.layleft > div > div.padd > div > div > div.el-table > div> table > tbody > tr > td.el-table_1_column_9 > div > button:nth-child(1)
    Input Text    Xpath=//*[@id="app"]/div/div[2]/div/div[2]/div/div/div[4]/div/div/div[2]/form/div/div[2]/div/div/div/input    ${amount}
    Click Button    Xpath=//*[@id="app"]/div/div[2]/div/div[2]/div/div/div[4]/div/div/div[3]/div/button[2]
    Wait Until Page Contains Element    Xpath=/html/body/div[3]/div/div[3]/button[2]
    Click Button    Xpath=/html/body/div[3]/div/div[3]/button[2]
    sleep    2
    ${success}=    Run Keyword And Return Status    MyContain    操作成功
    Should Be True    ${success}

SearchForPressed
    [Arguments]    ${applicant}
    Wait Until Page Contains Element    css=#app > div > div.layleft > div > div.padd > div > div > div.el-row > div:nth-child(1) > div.el-input.el-input--mini.el-input--suffix > input
    Input Text    css=#app > div > div.layleft > div > div.padd > div > div > div.el-row > div:nth-child(1) > div.el-input.el-input--mini.el-input--suffix > input    ${applicant}
    Myclick    Xpath=/html/body/div[1]/div/div[2]/div/div[2]/div/div/div[1]/div[2]/div[2]/div/input
    Myclick    css=ul > li.el-select-dropdown__item:nth-child(3) > span
    Click Button    css=#app > div > div.layleft > div > div.padd > div > div > div.el-row > div:nth-child(3) > button:nth-child(1)

LargeAmountPay
    [Arguments]    ${amount}    ${ticketName}=testLAP    ${comment}=comment
    Wait Until Page Contains Element    Xpath=//*[@id="app"]/div/div[2]/div/div[2]/div/div/div[2]/div[3]/table/tbody/tr[1]/td[9]/div/button[2]
    Myclick    Xpath=//*[@id="app"]/div/div[2]/div/div[2]/div/div/div[2]/div[3]/table/tbody/tr[1]/td[9]/div/button[2]
    Input Text    Xpath=//*[@id="app"]/div/div[2]/div/div[2]/div/div/div[4]/div/div/div[2]/form/div/div[6]/div/div/div[1]/input    ${ticketName}
    Input Text    Xpath=//*[@id="app"]/div/div[2]/div/div[2]/div/div/div[4]/div/div/div[2]/form/div/div[7]/div/div/div[1]/input    ${amount}
    Input Text    Xpath=//*[@id="app"]/div/div[2]/div/div[2]/div/div/div[4]/div/div/div[2]/form/div/div[8]/div/div/div[1]/input    ${comment}
    Click Button    Xpath=//*[@id="app"]/div/div[2]/div/div[2]/div/div/div[4]/div/div/div[3]/div/button[2]
    ${receiverE}=    Run Keyword And Return Status    Page Should Contain Element    Xpath=//*[@id="app"]/div/div[2]/div/div[2]/div/div/div[4]/div/div/div[2]/form/div/div[3]/div/div/div[2]
    ${ticketNameE}=    Run Keyword And Return Status    Page Should Contain Element    Xpath=//*[@id="app"]/div/div[2]/div/div[2]/div/div/div[4]/div/div/div[2]/form/div/div[6]/div/div/div[2]
    ${amountE}=    Run Keyword And Return Status    Page Should Contain Element    Xpath=//*[@id="app"]/div/div[2]/div/div[2]/div/div/div[4]/div/div/div[2]/form/div/div[7]/div/div/div[2]
    ${success}=    Run Keyword And Return Status    MyContain    新增成功
    Run Keyword If    ${receiverE}    LogError    Xpath=//*[@id="app"]/div/div[2]/div/div[2]/div/div/div[4]/div/div/div[2]/form/div/div[3]/div/div/div[2]
    Run Keyword If    ${ticketNameE}    LogError    Xpath=//*[@id="app"]/div/div[2]/div/div[2]/div/div/div[4]/div/div/div[2]/form/div/div[6]/div/div/div[2]
    Run Keyword If    ${amountE}    LogError    Xpath=//*[@id="app"]/div/div[2]/div/div[2]/div/div/div[4]/div/div/div[2]/form/div/div[7]/div/div/div[2]
    Should Be True    ${success}

DoLAP
    Myclick    Xpath=/html/body/div[1]/div/div[2]/div/div[2]/div/div/div/div[2]/div[1]/div[1]/div[1]/div[2]/div/input
    Myclick    css=body > div.el-select-dropdown.el-popper > div.el-scrollbar > div.el-select-dropdown__wrap.el-scrollbar__wrap > ul > li.el-select-dropdown__item
    Click Button    Xpath=/html/body/div[1]/div/div[2]/div/div[2]/div/div/div/div[2]/div[1]/div[1]/div[2]/button
    Wait Until Page Contains Element    Xpath=//*[@id="pane-first"]/div[2]/div[3]/table/tbody/tr[1]/td[8]/div/button[1]
    Myclick    Xpath=//*[@id="pane-first"]/div[2]/div[3]/table/tbody/tr[1]/td[8]/div/button[1]
    Myclick    Xpath=/html/body/div[1]/div/div[2]/div/div[2]/div/div/div[2]/div/div/div[2]/form/div/div[9]/div/div/div/div/input
    Myclick    css=body > div:nth-child(11) > div.el-scrollbar > div.el-select-dropdown__wrap.el-scrollbar__wrap > ul > li:nth-child(2)
    Myclick    Xpath=/html/body/div[1]/div/div[2]/div/div[2]/div/div/div[2]/div/div/div[3]/div/button[2]
    Myclick    css=body > div.el-message-box__wrapper > div > div.el-message-box__btns > button.el-button.el-button--default.el-button--small.el-button--primary
    ${success}=    Run Keyword And Return Status    MyContain    操作成功
    Should Be True    ${success}

RejectLAP
    Myclick    Xpath=/html/body/div[1]/div/div[2]/div/div[2]/div/div/div/div[2]/div[1]/div[1]/div[1]/div[2]/div/input
    Myclick    css=body > div.el-select-dropdown.el-popper > div.el-scrollbar > div.el-select-dropdown__wrap.el-scrollbar__wrap > ul > li.el-select-dropdown__item
    Click Button    Xpath=/html/body/div[1]/div/div[2]/div/div[2]/div/div/div/div[2]/div[1]/div[1]/div[2]/button
    Wait Until Page Contains Element    Xpath=//*[@id="pane-first"]/div[2]/div[3]/table/tbody/tr[1]/td[8]/div/button[1]
    Myclick    Xpath=//*[@id="pane-first"]/div[2]/div[3]/table/tbody/tr[1]/td[8]/div/button[1]
    Myclick    Xpath=/html/body/div[1]/div/div[2]/div/div[2]/div/div/div[2]/div/div/div[2]/form/div/div[9]/div/div/div/div/input
    Myclick    css=body > div:nth-child(11) > div.el-scrollbar > div.el-select-dropdown__wrap.el-scrollbar__wrap > ul > li:nth-child(3)
    Myclick    Xpath=/html/body/div[1]/div/div[2]/div/div[2]/div/div/div[2]/div/div/div[3]/div/button[2]
    Myclick    css=body > div.el-message-box__wrapper > div > div.el-message-box__btns > button.el-button.el-button--default.el-button--small.el-button--primary
    ${success}=    Run Keyword And Return Status    MyContain    操作成功
    Should Be True    ${success}
